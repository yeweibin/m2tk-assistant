<?xml version = "1.0" encoding = "UTF-8"?>
<M2TKTemplate>
    <TableTemplate name="program_association_section" group="PSI/PAT">
        <TableId id="0x00">
            <DisplayName str="节目关联表 (PAT)"/>
        </TableId>
        <TableBody>
            <Field name="table_id" length="8" encoding="uimsbf"/>
            <Field name="section_syntax_indicator" length="1" encoding="bslbf"/>
            <Field name="0" length="1" encoding="bslbf"/>
            <Field name="reserved" length="2" encoding="bslbf"/>
            <Field name="section_length" length="12" encoding="uimsbf">
                <FieldPresentation>
                    <Prefix str="段长度"/>
                </FieldPresentation>
            </Field>
            <Field name="transport_stream_id" length="16" encoding="uimsbf">
                <FieldPresentation>
                    <Prefix str="传输流号"/>
                </FieldPresentation>
            </Field>
            <Field name="reserved" length="2" encoding="bslbf"/>
            <Field name="version_number" length="5" encoding="bslbf">
                <FieldPresentation>
                    <Prefix str="版本号"/>
                    <Format str="%d"/>
                </FieldPresentation>
            </Field>
            <Field name="current_next_indicator" length="1" encoding="bslbf"/>
            <Field name="section_number" length="8" encoding="uimsbf">
                <FieldPresentation>
                    <Prefix str="当前分段号"/>
                </FieldPresentation>
            </Field>
            <Field name="last_section_number" length="8" encoding="uimsbf">
                <FieldPresentation>
                    <Prefix str="最后分段号"/>
                </FieldPresentation>
            </Field>
            <Loop name="program_association_loop" length_field="implicit" length_correction="-4">
                <LoopPresentation>
                    <LoopHeader str="节目关联描述"/>
                    <LoopEmpty str="***无节目关联描述***"/>
                    <LoopEntry>
                        <Prefix str="节目关联"/>
                    </LoopEntry>
                </LoopPresentation>
                <Body>
                    <Field name="program_number" length="16" encoding="uimsbf">
                        <FieldPresentation>
                            <Prefix str="节目号"/>
                        </FieldPresentation>
                    </Field>
                    <Field name="reserved" length="3" encoding="bslbf"/>
                    <If>
                        <Condition>
                            <CompareWithConst field="program_number" comp_op="equals" const="0"/>
                        </Condition>
                        <Then>
                            <Field name="network_pid" length="13" encoding="uimsbf">
                                <FieldPresentation>
                                    <Prefix str="NIT位置"/>
                                    <Format str="pid = 0x%04X (%d)"/>
                                </FieldPresentation>
                            </Field>
                        </Then>
                        <Else>
                            <Field name="program_map_pid" length="13" encoding="uimsbf">
                                <FieldPresentation>
                                    <Prefix str="PMT位置"/>
                                    <Format str="pid = 0x%04X (%d)"/>
                                </FieldPresentation>
                            </Field>
                        </Else>
                    </If>
                </Body>
            </Loop>
            <Field name="CRC_32" length="32" encoding="checksum">
                <FieldPresentation>
                    <Format str="%08X"/>
                </FieldPresentation>
            </Field>
        </TableBody>
        <UniqueKey>
            <FieldRef field="table_id"/>
            <FieldRef field="transport_stream_id"/>
            <FieldRef field="version_number"/>
            <FieldRef field="section_number"/>
        </UniqueKey>
    </TableTemplate>
    <TableTemplate name="conditional_access_section" group="PSI/CAT">
        <TableId id="0x01">
            <DisplayName str="条件接收表 (CAT)"/>
        </TableId>
        <TableBody>
            <Field name="table_id" length="8" encoding="uimsbf"/>
            <Field name="section_syntax_indicator" length="1" encoding="bslbf"/>
            <Field name="0" length="1" encoding="bslbf"/>
            <Field name="reserved" length="2" encoding="bslbf"/>
            <Field name="section_length" length="12" encoding="uimsbf">
                <FieldPresentation>
                    <Prefix str="段长度"/>
                </FieldPresentation>
            </Field>
            <Field name="reserved" length="18" encoding="bslbf"/>
            <Field name="version_number" length="5" encoding="bslbf">
                <FieldPresentation>
                    <Prefix str="版本号"/>
                    <Format str="%d"/>
                </FieldPresentation>
            </Field>
            <Field name="current_next_indicator" length="1" encoding="bslbf"/>
            <Field name="section_number" length="8" encoding="uimsbf">
                <FieldPresentation>
                    <Prefix str="当前分段号"/>
                </FieldPresentation>
            </Field>
            <Field name="last_section_number" length="8" encoding="uimsbf">
                <FieldPresentation>
                    <Prefix str="最后分段号"/>
                </FieldPresentation>
            </Field>
            <Loop name="ca_descriptor_loop" length_field="implicit" length_correction="-4">
                <LoopPresentation>
                    <LoopHeader str="条件接收描述"/>
                    <LoopEmpty str="***无条件接收描述***"/>
                </LoopPresentation>
                <Body>
                    <Descriptor/>
                </Body>
            </Loop>
            <Field name="CRC_32" length="32" encoding="checksum">
                <FieldPresentation>
                    <Format str="%08X"/>
                </FieldPresentation>
            </Field>
        </TableBody>
        <UniqueKey>
            <FieldRef field="table_id"/>
            <FieldRef field="version_number"/>
            <FieldRef field="section_number"/>
        </UniqueKey>
    </TableTemplate>
    <TableTemplate name="program_map_section" group="PSI/PMT">
        <TableId id="0x02">
            <DisplayName str="节目映射表 (PMT)"/>
        </TableId>
        <TableBody>
            <Field name="table_id" length="8" encoding="uimsbf"/>
            <Field name="section_syntax_indicator" length="1" encoding="bslbf"/>
            <Field name="0" length="1" encoding="bslbf"/>
            <Field name="reserved" length="2" encoding="bslbf"/>
            <Field name="section_length" length="12" encoding="uimsbf">
                <FieldPresentation>
                    <Prefix str="段长度"/>
                </FieldPresentation>
            </Field>
            <Field name="program_number" length="16" encoding="uimsbf">
                <FieldPresentation>
                    <Prefix str="节目号"/>
                </FieldPresentation>
            </Field>
            <Field name="reserved" length="2" encoding="bslbf"/>
            <Field name="version_number" length="5" encoding="bslbf">
                <FieldPresentation>
                    <Prefix str="版本号"/>
                    <Format str="%d"/>
                </FieldPresentation>
            </Field>
            <Field name="current_next_indicator" length="1" encoding="bslbf"/>
            <Field name="section_number" length="8" encoding="uimsbf">
                <FieldPresentation>
                    <Prefix str="当前分段号"/>
                </FieldPresentation>
            </Field>
            <Field name="last_section_number" length="8" encoding="uimsbf">
                <FieldPresentation>
                    <Prefix str="最后分段号"/>
                </FieldPresentation>
            </Field>
            <Field name="reserved" length="3" encoding="bslbf"/>
            <Field name="pcr_pid" length="13" encoding="uimsbf">
                <FieldPresentation>
                    <Prefix str="PCR位置"/>
                    <Format str="pid = 0x%04X (%d)"/>
                </FieldPresentation>
            </Field>
            <Field name="reserved" length="4" encoding="bslbf"/>
            <Field name="program_info_length" length="12" encoding="uimsbf"/>
            <Loop name="program_info_loop" length_field="program_info_length">
                <LoopPresentation>
                    <LoopHeader str="节目信息描述"/>
                    <LoopEmpty str="***无节目信息描述***"/>
                </LoopPresentation>
                <Body>
                    <Descriptor/>
                </Body>
            </Loop>
            <Loop name="elementary_stream_loop" length_field="implicit" length_correction="-4">
                <LoopPresentation>
                    <LoopHeader str="节目基本流"/>
                    <LoopEmpty str="***无节目基本流***"/>
                    <LoopEntry>
                        <Prefix str="基本流"/>
                    </LoopEntry>
                </LoopPresentation>
                <Body>
                    <Field name="stream_type" length="8" encoding="uimsbf">
                        <FieldPresentation>
                            <Prefix str="流类型"/>
                            <Format str="%d"/>
                            <Mapping>
                                <Value value="1">
                                    <ValString str="MPEG-1 视频"/>
                                </Value>
                                <Value value="2">
                                    <ValString str="MPEG-2 视频"/>
                                </Value>
                                <Value value="3">
                                    <ValString str="MPEG-1 音频"/>
                                </Value>
                                <Value value="4">
                                    <ValString str="MPEG-2 音频"/>
                                </Value>
                                <Value value="5">
                                    <ValString str="ISO 13818-1 私有段"/>
                                </Value>
                                <Value value="6">
                                    <ValString str="ISO 13818-1 PES包"/>
                                </Value>
                            </Mapping>
                        </FieldPresentation>
                    </Field>
                    <Field name="reserved" length="3" encoding="bslbf"/>
                    <Field name="elementary_PID" length="13" encoding="uimsbf">
                        <FieldPresentation>
                            <Prefix str="基本流位置"/>
                            <Format str="pid = 0x%04X (%d)"/>
                        </FieldPresentation>
                    </Field>
                    <Field name="reserved" length="4" encoding="bslbf"/>
                    <Field name="ES_info_length" length="12" encoding="uimsbf"/>
                    <Loop name="ES_info_loop" length_field="ES_info_length">
                        <LoopPresentation>
                            <LoopHeader str="基本流信息描述"/>
                            <LoopEmpty str="***无基本流信息描述***"/>
                        </LoopPresentation>
                        <Body>
                            <Descriptor/>
                        </Body>
                    </Loop>
                </Body>
            </Loop>
            <Field name="CRC_32" length="32" encoding="checksum">
                <FieldPresentation>
                    <Format str="%08X"/>
                </FieldPresentation>
            </Field>
        </TableBody>
    </TableTemplate>
    <TableTemplate name="ts_description_section" group="PSI/TSDT">
        <TableId id="0x03">
            <DisplayName str="传输流描述表 (TSDT)"/>
        </TableId>
        <TableBody>
            <Field name="table_id" length="8" encoding="uimsbf"/>
            <Field name="section_syntax_indicator" length="1" encoding="bslbf"/>
            <Field name="0" length="1" encoding="bslbf"/>
            <Field name="reserved" length="2" encoding="bslbf"/>
            <Field name="section_length" length="12" encoding="uimsbf">
                <FieldPresentation>
                    <Prefix str="段长度"/>
                </FieldPresentation>
            </Field>
            <Field name="reserved" length="18" encoding="bslbf"/>
            <Field name="version_number" length="5" encoding="bslbf">
                <FieldPresentation>
                    <Prefix str="版本号"/>
                    <Format str="%d"/>
                </FieldPresentation>
            </Field>
            <Field name="current_next_indicator" length="1" encoding="bslbf"/>
            <Field name="section_number" length="8" encoding="uimsbf">
                <FieldPresentation>
                    <Prefix str="当前分段号"/>
                </FieldPresentation>
            </Field>
            <Field name="last_section_number" length="8" encoding="uimsbf">
                <FieldPresentation>
                    <Prefix str="最后分段号"/>
                </FieldPresentation>
            </Field>
            <Loop name="descriptor_loop" length_field="implicit" length_correction="-4">
                <LoopPresentation>
                    <LoopHeader str="传输流描述"/>
                    <LoopEmpty str="***无传输流描述***"/>
                </LoopPresentation>
                <Body>
                    <Descriptor/>
                </Body>
            </Loop>
            <Field name="CRC_32" length="32" encoding="checksum">
                <FieldPresentation>
                    <Format str="%08X"/>
                </FieldPresentation>
            </Field>
        </TableBody>
        <UniqueKey>
            <FieldRef field="table_id"/>
            <FieldRef field="version_number"/>
            <FieldRef field="section_number"/>
        </UniqueKey>
    </TableTemplate>
    <DescriptorTemplate tag="0x09" name="ca_descriptor">
        <DisplayName str="条件接收描述符"/>
        <DescriptorBody>
            <Field name="descriptor_tag" length="8" encoding="uimsbf"/>
            <Field name="descriptor_length" length="8" encoding="uimsbf">
                <FieldPresentation>
                    <Prefix str="长度"/>
                </FieldPresentation>
            </Field>
            <Field name="ca_system_id" length="16" encoding="uimsbf">
                <FieldPresentation>
                    <Prefix str="CA系统号"/>
                    <Format str="%04X (%d)"/>
                </FieldPresentation>
            </Field>
            <Field name="reserved" length="3" encoding="bslbf"/>
            <Field name="ca_pid" length="13" encoding="uimsbf">
                <FieldPresentation>
                    <Prefix str="CA数据流"/>
                    <Format str="pid = 0x%04X (%d)"/>
                </FieldPresentation>
            </Field>
            <Field name="private_data" encoding="octets" length_field="implicit">
                <FieldPresentation>
                    <Prefix str="私有数据"/>
                    <Format str="lowercase"/>
                </FieldPresentation>
            </Field>
        </DescriptorBody>
    </DescriptorTemplate>
</M2TKTemplate>