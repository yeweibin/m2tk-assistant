<?xml version = "1.0" encoding = "UTF-8"?>
<M2TKTemplate>
    <TableTemplate name="program_association_section" standard="mpeg" group="PSI">
        <TableId id="0">
            <DisplayName str="PAT"/>
        </TableId>
        <TableBody>
            <Field name="table_id" length="8" encoding="uimsbf">
                <FieldPresentation>
                    <Prefix str="Table ID"/>
                    <Format str="0x%02X (%d)"/>
                </FieldPresentation>
            </Field>
            <Field name="section_syntax_indicator" length="1" encoding="bslbf">
                <FieldPresentation>
                    <Format str="%d"/>
                    <Mapping>
                        <Value value="0">
                            <ValString str="私有段"/>
                        </Value>
                        <Value value="1">
                            <ValString str="扩展私有段"/>
                        </Value>
                    </Mapping>
                </FieldPresentation>
            </Field>
            <Field name="0" length="1" encoding="bslbf"/>
            <Field name="reserved" length="2" encoding="bslbf"/>
            <Field name="section_length" length="12" encoding="uimsbf">
                <FieldPresentation>
                    <Prefix str="段长度"/>
                </FieldPresentation>
            </Field>
            <Field name="transport_stream_id" length="16" encoding="uimsbf">
                <FieldPresentation>
                    <Prefix str="传输流号"/>
                </FieldPresentation>
            </Field>
            <Field name="reserved" length="2" encoding="bslbf"/>
            <Field name="version_number" length="5" encoding="bslbf"/>
            <Field name="current_next_indicator" length="1" encoding="bslbf"/>
            <Field name="section_number" length="8" encoding="uimsbf">
                <FieldPresentation>
                    <Prefix str="当前分段号"/>
                </FieldPresentation>
            </Field>
            <Field name="last_section_number" length="8" encoding="uimsbf">
                <FieldPresentation>
                    <Prefix str="最后分段号"/>
                </FieldPresentation>
            </Field>
            <Loop name="program_association_loop" length_field="implicit" length_correction="-4">
                <LoopPresentation>
                    <NoLoopHeader/>
                    <LoopEmpty str="无节目描述"/>
                    <LoopEntry>
                        <Prefix str="节目映射"/>
                    </LoopEntry>
                </LoopPresentation>
                <Body>
                    <Field name="program_number" length="16" encoding="uimsbf">
                        <FieldPresentation>
                            <Prefix str="节目号"/>
                        </FieldPresentation>
                    </Field>
                    <Field name="reserved" length="3" encoding="bslbf"/>
                    <If>
                        <Condition>
                            <CompareWithConst field="program_number" comp_op="equals" const="0"/>
                        </Condition>
                        <Then>
                            <Field name="network_pid" length="13" encoding="uimsbf">
                                <FieldPresentation>
                                    <Prefix str="NIT PID"/>
                                    <Format str="0x%04X"/>
                                </FieldPresentation>
                            </Field>
                        </Then>
                        <Else>
                            <Field name="program_map_pid" length="13" encoding="uimsbf">
                                <FieldPresentation>
                                    <Prefix str="PMT PID"/>
                                    <Format str="0x%04X"/>
                                </FieldPresentation>
                            </Field>
                        </Else>
                    </If>
                </Body>
            </Loop>
            <Field name="CRC_32" length="32" encoding="checksum">
                <FieldPresentation/>
            </Field>
        </TableBody>
        <UniqueKey>
            <FieldRef field="table_id"/>
            <FieldRef field="transport_stream_id"/>
            <FieldRef field="version_number"/>
            <FieldRef field="section_number"/>
        </UniqueKey>
    </TableTemplate>
    <TableTemplate name="conditional_access_section" standard="mpeg" group="PSI">
        <TableId id="1">
            <DisplayName str="CAT"/>
        </TableId>
        <TableBody>
            <Field name="table_id" length="8" encoding="uimsbf"/>
            <Field name="section_syntax_indicator" length="1" encoding="bslbf"/>
            <Field name="0" length="1" encoding="bslbf"/>
            <Field name="reserved" length="2" encoding="bslbf"/>
            <Field name="section_length" length="12" encoding="uimsbf"/>
            <Field name="reserved" length="18" encoding="bslbf"/>
            <Field name="version_number" length="5" encoding="bslbf"/>
            <Field name="current_next_indicator" length="1" encoding="bslbf"/>
            <Field name="section_number" length="8" encoding="uimsbf">
                <FieldPresentation>
                    <Prefix str="当前分段号"/>
                </FieldPresentation>
            </Field>
            <Field name="last_section_number" length="8" encoding="uimsbf">
                <FieldPresentation>
                    <Prefix str="最后分段号"/>
                </FieldPresentation>
            </Field>
            <Loop name="ca_descriptor_loop" length_field="implicit" length_correction="-4">
                <LoopPresentation>
                    <NoLoopHeader/>
                    <LoopEmpty str="无条件接收描述符"/>
                </LoopPresentation>
                <Body>
                    <Descriptor/>
                </Body>
            </Loop>
            <Field name="CRC_32" length="32" encoding="checksum">
                <FieldPresentation/>
            </Field>
        </TableBody>
        <UniqueKey>
            <FieldRef field="table_id"/>
            <FieldRef field="version_number"/>
            <FieldRef field="section_number"/>
        </UniqueKey>
    </TableTemplate>
    <TableTemplate name="program_map_section" standard="mpeg">
        <TableId id="2">
            <DisplayName str="PMT"/>
        </TableId>
        <TableBody>
            <Field name="table_id" length="8" encoding="uimsbf">
                <FieldPresentation>
                    <Prefix str="Table ID"/>
                    <Format str="0x%02x"/>
                </FieldPresentation>
            </Field>
            <Field name="section_syntax_indicator" length="1" encoding="bslbf">
                <FieldPresentation>
                    <Prefix str="Section syntax indicator"/>
                    <Format str="%d"/>
                </FieldPresentation>
            </Field>
            <Field name="0" length="1" encoding="bslbf"/>
            <Field name="reserved" length="2" encoding="bslbf"/>
            <Field name="section_length" length="12" encoding="uimsbf">
                <FieldPresentation>
                    <Prefix str="分段长度"/>
                </FieldPresentation>
            </Field>
            <Field name="program_number" length="16" encoding="uimsbf">
                <FieldPresentation>
                    <Prefix str="节目号"/>
                </FieldPresentation>
            </Field>
            <Field name="reserved" length="2" encoding="bslbf"/>
            <Field name="version_number" length="5" encoding="bslbf"/>
            <Field name="current_next_indicator" length="1" encoding="bslbf"/>
            <Field name="section_number" length="8" encoding="uimsbf">
                <FieldPresentation>
                    <Prefix str="当前分段号"/>
                </FieldPresentation>
            </Field>
            <Field name="last_section_number" length="8" encoding="uimsbf">
                <FieldPresentation>
                    <Prefix str="最后分段号"/>
                </FieldPresentation>
            </Field>
            <Field name="reserved" length="3" encoding="bslbf"/>
            <Field name="pcr_pid" length="13" encoding="uimsbf">
                <FieldPresentation>
                    <Prefix str="PCR PID"/>
                    <Format str="0x%04X"/>
                </FieldPresentation>
            </Field>
            <Field name="reserved" length="4" encoding="bslbf"/>
            <Field name="program_info_length" length="12" encoding="uimsbf"/>
            <Loop name="program_info_loop" length_field="program_info_length">
                <LoopPresentation>
                    <NoLoopHeader/>
                    <LoopEmpty str="无节目信息描述符"/>
                </LoopPresentation>
                <Body>
                    <Descriptor/>
                </Body>
            </Loop>
            <Loop name="elementary_stream_loop" length_field="implicit" length_correction="-4">
                <LoopPresentation>
                    <NoLoopHeader/>
                    <LoopEmpty str="无节目ES信息描述"/>
                    <LoopEntry>
                        <Prefix str="基本流"/>
                    </LoopEntry>
                </LoopPresentation>
                <Body>
                    <Field name="stream_type" length="8" encoding="uimsbf">
                        <FieldPresentation>
                            <Prefix str="流类型"/>
                            <Format str="%d"/>
                            <Mapping>
                                <Value value="1">
                                    <ValString str="MPEG-1 视频"/>
                                </Value>
                                <Value value="2">
                                    <ValString str="MPEG-2 视频"/>
                                </Value>
                                <Value value="3">
                                    <ValString str="MPEG-1 音频"/>
                                </Value>
                                <Value value="4">
                                    <ValString str="MPEG-2 音频"/>
                                </Value>
                                <Value value="5">
                                    <ValString str="ISO 13818-1 私有段"/>
                                </Value>
                                <Value value="6">
                                    <ValString str="ISO 13818-1 PES包"/>
                                </Value>
                            </Mapping>
                        </FieldPresentation>
                    </Field>
                    <Field name="reserved" length="3" encoding="bslbf"/>
                    <Field name="elementary_PID" length="13" encoding="uimsbf">
                        <FieldPresentation>
                            <Prefix str="ES PID"/>
                            <Format str="0x%04X (%d)"/>
                        </FieldPresentation>
                    </Field>
                    <Field name="reserved" length="4" encoding="bslbf"/>
                    <Field name="ES_info_length" length="12" encoding="uimsbf"/>
                    <Loop name="ES_info_loop" length_field="ES_info_length">
                        <LoopPresentation>
                            <NoLoopHeader/>
                            <LoopEmpty str="无基本流信息描述符"/>
                        </LoopPresentation>
                        <Body>
                            <Descriptor/>
                        </Body>
                    </Loop>
                </Body>
            </Loop>
            <Field name="CRC_32" length="32" encoding="checksum">
                <FieldPresentation>
                    <Format str="%08x"/>
                </FieldPresentation>
            </Field>
        </TableBody>
    </TableTemplate>
    <DescriptorTemplate tag="9" name="ca_descriptor">
        <DisplayName str="CA Descriptor"/>
        <DescriptorBody>
            <Field name="descriptor_tag" length="8" encoding="uimsbf">
                <FieldPresentation>
                    <Prefix str="Tag"/>
                    <Format str="0x%02X"/>
                </FieldPresentation>
            </Field>
            <Field name="descriptor_length" length="8" encoding="uimsbf">
                <FieldPresentation>
                    <Prefix str="Length"/>
                </FieldPresentation>
            </Field>
            <Field name="ca_system_id" length="16" encoding="uimsbf">
                <FieldPresentation>
                    <Prefix str="CAS ID"/>
                    <Format str="0x%04X"/>
                    <Mapping>
                        <Value value="19190">
                            <ValString str="Pay4View CAS"/>
                        </Value>
                        <ValueRange val_min="19200" val_max="19203">
                            <ValString str="Pay4View CAS"/>
                        </ValueRange>
                    </Mapping>
                </FieldPresentation>
            </Field>
            <Field name="reserved" length="3" encoding="bslbf"/>
            <Field name="ca_pid" length="13" encoding="uimsbf">
                <FieldPresentation>
                    <Prefix str="ECM PID"/>
                    <Format str="0x%04X"/>
                </FieldPresentation>
            </Field>
            <Field name="private_data" encoding="octets" length_field="implicit">
                <FieldPresentation>
                    <Prefix str="Private data"/>
                    <Format str="lowercase"/>
                </FieldPresentation>
            </Field>
        </DescriptorBody>
    </DescriptorTemplate>
</M2TKTemplate>